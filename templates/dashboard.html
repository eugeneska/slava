{% extends "base.html" %}

{% block title %}–ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è - CleanPro{% endblock %}

{% block extra_css %}
<style>
    .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 1.5rem;
        margin-bottom: 2rem;
    }

    .stat-card {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 2rem;
        border-radius: 15px;
        box-shadow: 0 5px 20px rgba(102, 126, 234, 0.3);
        transition: transform 0.3s;
    }

    .stat-card:hover {
        transform: translateY(-5px);
    }

    .stat-card.success {
        background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);
    }

    .stat-card.info {
        background: linear-gradient(135deg, #4299e1 0%, #3182ce 100%);
    }

    .stat-card.warning {
        background: linear-gradient(135deg, #ed8936 0%, #dd6b20 100%);
    }

    .stat-icon {
        font-size: 2.5rem;
        margin-bottom: 1rem;
    }

    .stat-label {
        font-size: 0.875rem;
        opacity: 0.9;
        margin-bottom: 0.5rem;
    }

    .stat-value {
        font-size: 2rem;
        font-weight: 700;
    }

    .schedule-item {
        background: var(--light);
        padding: 1.5rem;
        border-radius: 12px;
        margin-bottom: 1rem;
        border-left: 4px solid var(--primary);
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

    .schedule-info h4 {
        margin-bottom: 0.5rem;
        color: var(--dark);
    }

    .schedule-details {
        color: var(--gray);
        font-size: 0.875rem;
    }

    .schedule-details span {
        margin-right: 1rem;
    }

    .empty-state {
        text-align: center;
        padding: 3rem;
        color: var(--gray);
    }

    .empty-state-icon {
        font-size: 4rem;
        margin-bottom: 1rem;
    }

    .quick-actions {
        display: flex;
        gap: 1rem;
        flex-wrap: wrap;
        margin-top: 1rem;
    }
</style>
{% endblock %}

{% block content %}
<h1>üìä –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è</h1>

<div class="stats-grid">
    <div class="stat-card">
        <div class="stat-icon">üë•</div>
        <div class="stat-label">–í—Å–µ–≥–æ –∫–ª–∏–µ–Ω—Ç–æ–≤</div>
        <div class="stat-value">{{ stats.clients_count or 0 }}</div>
    </div>

    <div class="stat-card info">
        <div class="stat-icon">üè¢</div>
        <div class="stat-label">–û–±—ä–µ–∫—Ç–æ–≤</div>
        <div class="stat-value">{{ stats.objects_count or 0 }}</div>
    </div>

    <div class="stat-card success">
        <div class="stat-icon">üëî</div>
        <div class="stat-label">–ê–∫—Ç–∏–≤–Ω—ã—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤</div>
        <div class="stat-value">{{ stats.employees_count or 0 }}</div>
    </div>

    <div class="stat-card warning">
        <div class="stat-icon">üõ†Ô∏è</div>
        <div class="stat-label">–£—Å–ª—É–≥</div>
        <div class="stat-value">{{ stats.services_count or 0 }}</div>
    </div>
</div>

<div class="stats-grid">
    <div class="stat-card">
        <div class="stat-icon">üìÖ</div>
        <div class="stat-label">–ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–æ —É–±–æ—Ä–æ–∫</div>
        <div class="stat-value">{{ stats.scheduled_count or 0 }}</div>
    </div>

    <div class="stat-card success">
        <div class="stat-icon">‚úÖ</div>
        <div class="stat-label">–í—ã–ø–æ–ª–Ω–µ–Ω–æ –∑–∞ –º–µ—Å—è—Ü</div>
        <div class="stat-value">{{ stats.completed_month or 0 }}</div>
    </div>

    <div class="stat-card info">
        <div class="stat-icon">üí∞</div>
        <div class="stat-label">–î–æ—Ö–æ–¥ –∑–∞ –º–µ—Å—è—Ü</div>
        <div class="stat-value">{{ "%.2f"|format(stats.revenue_month or 0) }} BYN</div>
    </div>
</div>

<h2>üìÜ –ë–ª–∏–∂–∞–π—à–∏–µ —É–±–æ—Ä–∫–∏</h2>

{% if stats.upcoming_schedules %}
    {% for schedule in stats.upcoming_schedules %}
    <div class="schedule-item">
        <div class="schedule-info">
            <h4>{{ schedule.ObjectName }}</h4>
            <div class="schedule-details">
                <span>üè¢ {{ schedule.ClientName }}</span>
                <span>üõ†Ô∏è {{ schedule.ServiceName }}</span>
                <span>üëî {{ schedule.EmployeeName or '–ù–µ –Ω–∞–∑–Ω–∞—á–µ–Ω' }}</span>
            </div>
        </div>
        <div>
            <span class="badge badge-info">
                üìÖ {{ schedule.ScheduledDate.strftime('%d.%m.%Y') }}
                {% if schedule.ScheduledTime %}
                    {{ schedule.ScheduledTime.strftime('%H:%M') }}
                {% endif %}
            </span>
        </div>
    </div>
    {% endfor %}
{% else %}
    <div class="empty-state">
        <div class="empty-state-icon">üì≠</div>
        <p>–ù–µ—Ç –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —É–±–æ—Ä–æ–∫</p>
        <a href="{{ url_for('add_schedule') }}" class="btn btn-primary" style="margin-top: 1rem;">–î–æ–±–∞–≤–∏—Ç—å —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ</a>
    </div>
{% endif %}

<h2 style="margin-top: 2rem;">üöÄ –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è</h2>
<div class="quick-actions">
    <a href="{{ url_for('add_client') }}" class="btn btn-primary">‚ûï –î–æ–±–∞–≤–∏—Ç—å –∫–ª–∏–µ–Ω—Ç–∞</a>
    <a href="{{ url_for('add_object') }}" class="btn btn-success">‚ûï –î–æ–±–∞–≤–∏—Ç—å –æ–±—ä–µ–∫—Ç</a>
    <a href="{{ url_for('add_employee') }}" class="btn btn-info">‚ûï –î–æ–±–∞–≤–∏—Ç—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞</a>
    <a href="{{ url_for('add_schedule') }}" class="btn btn-warning">‚ûï –î–æ–±–∞–≤–∏—Ç—å —É–±–æ—Ä–∫—É</a>
</div>
{% endblock %}